<!-- Page Breadcrumb -->
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="rst-breadcrumb">
        <a href="#"><span>Home</span></a>
        <span>></span>
        <a href="#"><span>Perfil</span></a>
      </div>
    </div>
  </div>
</div>
<!-- End Page Breadcrumb -->

<!-- Section Register -->
<section id="rst-account-page">
  <div class="container">
    <div class="row">


        <div class="col-sm-8">
          <div class="rst-section-title rst-section-title-box">
            <h4>Dados do Perfil</h4>
          </div> <!-- end section title -->
          <div class="rst-accsetting">
            <div class="rst-account-setting">
              <div id="telephone-new-div">
                <% if @personal_profile.telephones.size < 3 %>
                  <%= form_for @telephone , remote: true do |telephone| %>
                    <div class="rst-setting">
                          <span><%= telephone.label :number, "Novo Telefone" %></span>
                          <%= telephone.text_field :number, class: 'rst-pageinput phone-field', id: 'telephone-new', maxlength: '15' %>
                          <%= telephone.submit "+", class: 'rst-pagebutton phone-button' %>
                    </div>
                  <% end %>
                <% end %>
              </div>
              <div class="rst-setting" id="telephones-list">
                <% @personal_profile.telephones.each_with_index do |telephone, i| %>
                  <%= form_for telephone, remote: true do |t| %>
                    <div class="rst-setting">
                          <span><%= t.label :number, "Telefone (#{i + 1})"  %></span>
                          <%= t.text_field :number, value: telephone.number, class: 'rst-pageinput phone-field-list', maxlength: '15' %>
                          <%= t.submit "Atualizar", class: 'rst-pagebutton phone-button' %>
                          <%= link_to telephone, method: :delete, data: { confirm: 'Tem certeza que deseja deletar esse telefone?' }, class: 'rst-pagebutton phone-button', remote: true do %>
                            <i class="fa fa-trash"></i>
                          <% end %>
                    </div>
                  <% end %>
                <% end %>
              </div>
              <%= form_for personal_profile, url: personal_profiles_update_path do |f| %>
              <div class="rst-setting">
                <span><%= f.label :name, "Nome" %></span>
                <%= f.text_field :name, value: @personal_profile.name, class: 'rst-pageinput' %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :street, "Rua" %></span>
                <%= f.text_field :street, value: @personal_profile.street, class: 'rst-pageinput' %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :complement, "Complemento" %></span>
                <%= f.text_field :complement, value: @personal_profile.complement, class: 'rst-pageinput' %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :neighborhood, "Bairro" %></span>
                <%= f.text_field :neighborhood, value: @personal_profile.neighborhood, class: 'rst-pageinput' %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :state, "Estado" %></span>
                <%= f.select(:state_id, states_for_select(@personal_profile.state_id), {}, :class => 'rst-pageinput') %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :city, "Cidade" %></span>
                <%= f.grouped_collection_select(
                      :city_id,
                      State.all.includes(:cities),
                      :cities,
                      :name,
                      :id,
                      :name,
                      {selected: (@personal_profile.city.id if @personal_profile.city.present?)},
                      class: 'rst-pageinput',
                      include_blank: true
                    )
                %>
              </div>
              <div class="rst-setting">
                <span><%= f.label :zip_code, "CEP" %></span>
                <%= f.text_field :zip_code, value: @personal_profile.zip_code, class: 'rst-pageinput' %>
                <%= hidden_field_tag :id, @personal_profile.id %>
              </div>
              <%= f.submit "SALVAR ALTERAÇÕES", class: 'rst-pagebutton' %>
            </div>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="rst-section-title rst-section-title-box">
            <h4>Ofertas</h4>
          </div> <!-- end section title -->
          <aside class="widget widget_adv">
            <% @ads_med.each do |ad| %>
              <%= link_to ad, class: 'photobox-170x170' do %>
                <%= image_tag ad.avatar(:medium) %>
              <% end %>
            <% end %>
            <div class="clear"></div>
          </aside>
      <% end %>
    </div>
  </div>
</section>

<script type="text/javascript">
  jQuery(function($){
    $('#telephone-new').inputmask('(99) 9999[9]-9999', {greedy: false, clearIncomplete: true});
   $('#personal_profile_zip_code').inputmask('99999-999', {greedy: false, clearIncomplete: true});
  });
</script>

<%= javascript_include_tag 'populate_city_select' %>
